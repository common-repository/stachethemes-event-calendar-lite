"use strict";(globalThis.webpackChunkstec=globalThis.webpackChunkstec||[]).push([[6818],{42743:(e,t,a)=>{a.r(t),a.d(t,{InputSocialLinks:()=>h,UncontrolledInputSocialLinks:()=>d,default:()=>_});var n=a(8403),l=a(73772),s=a(26960),c=a(26878),r=a(52779),i=a(75761),o=a(78565),u=a(77160),m=a(32488);const __=l.__,d=e=>{const[t,a]=(0,c.useState)(e.defaultLinks);return React.createElement(n.StecDiv,{className:"stec-input-social-links"},React.createElement(o.default,{text:e.title}),t.map(((l,c)=>React.createElement(n.StecDiv,{key:c,className:"stec-input-social-link-item"},React.createElement(u.default,{value:l.icon,onPick:n=>{((n,l)=>{const c=(0,s.cloneDeep)(t);c[l].icon=n,a(c),e.onChange&&e.onChange(c)})(n,c)}}),React.createElement(m.InputText,{value:l.url,placeholder:__("Social link URL","stachethemes_event_calendar_lite"),onChange:n=>{((n,l)=>{const c=(0,s.cloneDeep)(t);c[l].url=n,a(c),e.onChange&&e.onChange(c)})(n,c)}}),React.createElement(n.StecSpan,{className:"stec-input-social-link-item-remove",onClick:()=>{(n=>{const l=(0,s.cloneDeep)(t).filter(((e,t)=>t!==n));a(l),e.onChange&&e.onChange(l)})(c)}},React.createElement("i",{className:"fa-solid fa-times"}))))),React.createElement(r.default,{className:"blue",label:__("Add social link","stachethemes_event_calendar_lite"),onClick:()=>{const n=(0,s.cloneDeep)(t);n.push({icon:"",url:""}),a(n),e.onChange&&e.onChange(n)}}),React.createElement(i.default,{text:e.description}))},h=e=>{const t=e.value;return React.createElement(n.StecDiv,{className:"stec-input-social-links"},React.createElement(o.default,{text:e.title}),e.links.map(((a,l)=>React.createElement(n.StecDiv,{key:l,className:"stec-input-social-link-item"},React.createElement(u.default,{value:a.icon,onPick:a=>{((a,n)=>{const l=(0,s.cloneDeep)(t);l[n].icon=a,e.onChange(l)})(a,l)}}),React.createElement(m.InputText,{value:a.url,placeholder:__("Social link URL","stachethemes_event_calendar_lite"),onChange:a=>{((a,n)=>{const l=(0,s.cloneDeep)(t);l[n].url=a,e.onChange(l)})(a,l)}}),React.createElement(n.StecSpan,{className:"stec-input-social-link-item-remove",onClick:()=>{(a=>{const n=(0,s.cloneDeep)(t).filter(((e,t)=>t!==a));e.onChange(n)})(l)}},React.createElement("i",{className:"fa-solid fa-times"}))))),React.createElement(r.default,{className:"blue",label:__("Add social link","stachethemes_event_calendar_lite"),onClick:()=>{const a=(0,s.cloneDeep)(t);a.push({icon:"",url:""}),e.onChange(a)}}),React.createElement(i.default,{text:e.description}))},_=h},39393:(e,t,a)=>{a.r(t),a.d(t,{InputTextarea:()=>u,UncontrolledInputTextarea:()=>o,default:()=>m});var n=a(8403),l=a(26878),s=a(75761),c=a(78565),r=a(13839),i=a(10382);const o=e=>{const[t,a]=(0,l.useState)(e.defaultValue||""),[o,u]=(0,l.useState)(!1),[m,d]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{if((o||e.wasSubmitted)&&e.regex){const a=new RegExp(e.regex).test(t);d(!1===a)}}),[t,e.regex,e.wasSubmitted,o]),React.createElement(n.StecDiv,{className:"stec-input-textarea-wrapper"},React.createElement("label",null,React.createElement(r.default,{style:{justifyContent:"space-between"}},React.createElement(c.default,{text:e.title})),React.createElement("textarea",{style:e.inputStyle,onBlur:()=>{u(!0)},type:"text",name:e.name,placeholder:e.placeholder,onChange:t=>{a(t.target.value),e.onChange&&e.onChange(t.target.value)},value:t}),React.createElement(i.default,{floating:!0,text:e.errorMessage,display:m}),React.createElement(s.default,{text:e.description})))},u=e=>{const[t,a]=(0,l.useState)(!1),[o,u]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{if((t||e.wasSubmitted)&&e.regex){const t=new RegExp(e.regex).test(e.value);u(!1===t)}}),[e.value,e.regex,e.wasSubmitted,t]),React.createElement(n.StecDiv,{className:"stec-input-textarea-wrapper"},React.createElement("label",null,React.createElement(r.default,{style:{justifyContent:"space-between"}},React.createElement(c.default,{text:e.title})),React.createElement("textarea",{style:e.inputStyle,onBlur:()=>{a(!0)},type:"text",name:e.name,placeholder:e.placeholder,onChange:t=>{e.onChange(t.target.value)},value:e.value}),React.createElement(i.default,{floating:!0,text:e.errorMessage,display:o}),React.createElement(s.default,{text:e.description})))},m=u},80745:(e,t,a)=>{a.r(t),a.d(t,{UpsertForm:()=>b,default:()=>k});var n=a(52779),l=a(93699),s=a(62552),c=a(59249),r=a(32779),i=a(42743),o=a(32488),u=a(39393),m=a(48596),d=a(22819),h=a(98196),_=a(91927),p=a(81148),g=a(6405),f=a(13328),v=a(8403),E=a(73772),R=a(26960),y=a(26878),S=a(60799),C=a(32228);const __=E.__,x=e=>{const{wasSubmitted:t,focusFieldsRef:a,postData:n}=e,{items:l,ready:s,error:c}=(0,f.usePermissions)();return!s||c?null:React.createElement(React.Fragment,null,React.createElement(f.WithMaybeDisplayPermissions,{type:"edit_permission"},React.createElement(d.default,null),React.createElement(r.UncontrolledInputSelect,{ref:e=>a.current.edit_permission=e,multiple:!0,title:__("Edit permission","stachethemes_event_calendar_lite"),options:l.filter((e=>"stec_public"!==e.value)),defaultValue:n.current.meta.edit_permission,description:__("Who can edit this guest","stachethemes_event_calendar_lite"),required:!0,errorMessage:__("The edit permission cannot be empty","stachethemes_event_calendar_lite"),wasSubmitted:t,onChange:e=>{n.current.meta.edit_permission=e}})),React.createElement(f.WithMaybeDisplayPermissions,{type:"use_permission"},React.createElement(d.default,null),React.createElement(r.UncontrolledInputSelect,{ref:e=>a.current.use_permission=e,multiple:!0,title:__("Use permission","stachethemes_event_calendar_lite"),options:l,defaultValue:n.current.meta.use_permission,description:__("Who can add this guest to their events","stachethemes_event_calendar_lite"),required:!0,errorMessage:__("The use permission cannot be empty","stachethemes_event_calendar_lite"),wasSubmitted:t,onChange:e=>{n.current.meta.use_permission=e}})))};function b(e){const[t,a]=(0,y.useState)(!1),[r,_]=(0,y.useState)(0),f=(0,y.useRef)(!1),v=C.default,E=(0,y.useRef)((0,R.cloneDeep)(e.template?e.template:v)),b=(0,y.useRef)([]),k=(e,t=!0)=>{E.current=t?(0,R.cloneDeep)(e):e,_((0,R.uniqueId)())},w=E.current.id?[React.createElement("i",{key:"icon",className:"fa-solid fa-pen-to-square"}),__("Edit guest","stachethemes_event_calendar_lite")]:[React.createElement("i",{key:"icon",className:"fa-solid fa-plus"}),__("Add new guest","stachethemes_event_calendar_lite")];return React.createElement(m.default,{title:w,key:r},React.createElement(p.default,{postData:E}),React.createElement(d.default,null),React.createElement(c.UncontrolledInputImages,{multiple:!1,defaultValue:E.current.meta.photo,title:__("Photo","stachethemes_event_calendar_lite"),buttonTitle:__("Add Photo","stachethemes_event_calendar_lite"),description:__("Add photo for this guest from the WordPress Media Library","stachethemes_event_calendar_lite"),onChange:e=>{E.current.meta.photo=e.map((e=>(e.dimensions&&delete e.dimensions,e)))}}),React.createElement(d.default,null),React.createElement(o.UncontrolledInputText,{ref:e=>b.current.name=e,title:__("Name"),defaultValue:E.current.name,placeholder:__("Guest name","stachethemes_event_calendar_lite"),description:__("Guest display name"),required:!0,regex:(0,g.getRegexByType)("title"),errorMessage:__("The guest must have a name","stachethemes_event_calendar_lite"),wasSubmitted:t,onChange:e=>{E.current.name=e}}),React.createElement(d.default,null),React.createElement(o.UncontrolledInputText,{ref:e=>b.current.slug=e,title:__("Slug"),defaultValue:E.current.slug,placeholder:__("Guest slug","stachethemes_event_calendar_lite"),description:__("Leave empty to auto-generate"),required:!1,regex:(0,g.getRegexByType)("slug"),errorMessage:__("The guest must have a valid slug","stachethemes_event_calendar_lite"),onChange:e=>{E.current.slug=e},wasSubmitted:t}),React.createElement(d.default,null),React.createElement(s.UncontrolledInputColor,{title:__("Color","stachethemes_event_calendar_lite"),defaultValue:E.current.meta.color,description:__("Guest color","stachethemes_event_calendar_lite"),onChange:e=>{E.current.meta.color=e}}),React.createElement(d.default,null),React.createElement(u.UncontrolledInputTextarea,{title:__("Description","stachethemes_event_calendar_lite"),description:__("About this Guest","stachethemes_event_calendar_lite"),defaultValue:E.current.description,onChange:e=>{E.current.description=e}}),React.createElement(d.default,null),React.createElement(i.UncontrolledInputSocialLinks,{title:__("Social Links","stachethemes_event_calendar_lite"),description:__("Social links like Facebook, Twitter, Instagram...","stachethemes_event_calendar_lite"),defaultLinks:E.current.meta.social,onChange:e=>{E.current.meta.social=e}}),React.createElement(d.default,null),React.createElement(o.UncontrolledInputText,{ref:e=>b.current.email=e,type:"email",title:__("Email","stachethemes_event_calendar_lite"),placeholder:__("Email","stachethemes_event_calendar_lite"),description:__("Contact email","stachethemes_event_calendar_lite"),defaultValue:E.current.meta.email,regex:(0,g.getRegexByType)("email"),errorMessage:__("Invalid email","stachethemes_event_calendar_lite"),wasSubmitted:t,onChange:e=>{E.current.meta.email=e}}),React.createElement(d.default,null),React.createElement(x,{postData:E,focusFieldsRef:b,wasSubmitted:t}),React.createElement(d.default,null),React.createElement(n.default,{label:E.current.id?__("Update","stachethemes_event_calendar_lite"):__("Create","stachethemes_event_calendar_lite",0),className:"green",onClick:()=>{if(!0!==f.current){if(a(!0),!1===(()=>{const e=[{id:"name",regex:(0,g.getRegexByType)("title"),meta:!1,errorMessage:__("The guest must have a name","stachethemes_event_calendar_lite")},{id:"slug",regex:(0,g.getRegexByType)("slug"),meta:!1,errorMessage:__("The guest must have a valid slug","stachethemes_event_calendar_lite")},{id:"email",regex:(0,g.getRegexByType)("email"),meta:!0,errorMessage:__("Invalid email","stachethemes_event_calendar_lite")},{id:"use_permission",meta:!0,errorMessage:__("The use permission cannot be empty","stachethemes_event_calendar_lite")},{id:"edit_permission",meta:!0,errorMessage:__("The edit permission cannot be empty","stachethemes_event_calendar_lite")}];for(let t in e){const a=e[t],n=a.meta?E.current.meta[a.id]:E.current[a.id];let l=!0;if(l=a.regex?new RegExp(a.regex).test(n):Array.isArray(n)?n.length>0:!(!n||""===n),!1===l)return b.current[a.id]&&b.current[a.id].focus(),S.toast.error(a.errorMessage),!1}return!0})())return!1;S.toast.promise(new Promise(((t,a)=>{f.current=!0,async function(){try{let n;n=E.current.id?await(0,h.newApiPut)({route:"GUESTS",args:E.current.id,data:E.current,includeResponseStatus:!0,errorMessage:"auto"}):await(0,h.newApiPost)({route:"GUESTS",data:E.current,includeResponseStatus:!0,translateErrorCode:{term_exists:__("A guest with this name already exists","stachethemes_event_calendar_lite")},errorMessage:"auto"});const{status:l,data:s}=n;switch(l){case 201:return e.onGuestInserted&&e.onGuestInserted(s),k(s),(0,h.flushApiCache)({group:"taxonomy-stec_gst"}),t(__("Created","stachethemes_event_calendar_lite"));case 200:return e.onGuestInserted&&e.onGuestInserted(s),k(s),(0,h.flushApiCache)({group:"taxonomy-stec_gst"}),t(__("Updated","stachethemes_event_calendar_lite"));default:return a(__("Sorry, something went wrong","stachethemes_event_calendar_lite"))}}catch(e){return a(e.message)}}()})),{loading:__("Saving","stachethemes_event_calendar_lite"),success:e=>(f.current=!1,e),error:e=>(f.current=!1,e)})}else(0,S.toast)(__("Another action is in progress","stachethemes_event_calendar_lite"))}}),React.createElement(n.default,{label:__("Reset form","stachethemes_event_calendar_lite"),className:"yellow",style:{marginLeft:5},onClick:()=>{k(v),a(!1),(0,S.toast)(__("The form has been reset","stachethemes_event_calendar_lite"))}}),E.current.id&&React.createElement(l.default,{label:__("Delete","stachethemes_event_calendar_lite"),className:"red",style:{marginLeft:5},onClick:()=>{!0!==f.current?S.toast.promise(new Promise(((t,a)=>{f.current=!0,async function(){try{await(0,h.newApiDelete)({route:"GUESTS",args:E.current.id});e.onGuestDeleted&&e.onGuestDeleted(E.current);const a=(0,R.cloneDeep)(E.current);return a.id="",k(a,!1),(0,h.flushApiCache)({group:"taxonomy-stec_gst"}),t(__("Deleted","stachethemes_event_calendar_lite"))}catch(e){return a(e.message)}}()})),{loading:__("Deleting","stachethemes_event_calendar_lite"),success:e=>(f.current=!1,e),error:e=>(f.current=!1,e)}):(0,S.toast)(__("Another action is in progress","stachethemes_event_calendar_lite"))}}),React.createElement(n.default,{label:__("Back","stachethemes_event_calendar_lite"),className:"blue",style:{marginLeft:5},onClick:()=>{const t=!E.current.id;e.onBack(t)}}))}const k=function(){const{setActiveMenu:e,activeMenuParams:t}=(0,_.useDashboardMenu)(),a=a=>{let n=t.manageListQueryArgs||null;a&&(n=null),e({page:"guests-list",params:{initialQueryArgs:n}})};return React.createElement(React.Fragment,null,React.createElement(v.StecDiv,{className:"stec-dashboard-top-nav"},React.createElement(n.default,{className:"stcolor stec-dashboard-home-button",label:[React.createElement("i",{key:"icon",className:"fa-solid fa-home"}),__("Home","stachethemes_event_calendar_lite")],onClick:()=>{e({page:"home",params:{}})}}),React.createElement(n.default,{className:"blue",label:[React.createElement("i",{key:"icon",className:"fa-solid fa-list"}),__("Manage guests","stachethemes_event_calendar_lite")],onClick:a})),React.createElement(b,{template:t.template||!1,onBack:e=>{a(e)}}))}},32228:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});const n=void 0!==window.STEC_GUEST_TEMPLATE?window.STEC_GUEST_TEMPLATE:{name:"",slug:"",status:"publish",description:"",meta:{author:"",color:"#B4CFB0",photo:[],email:"",social:[],read_permission:["stec_public"],use_permission:["stec_private"],edit_permission:["stec_private"]}}}}]);