"use strict";(globalThis.webpackChunkstec=globalThis.webpackChunkstec||[]).push([[5199],{79051:(e,t,a)=>{a.r(t),a.d(t,{InputThumbType:()=>m,UncontrolledInputThumbType:()=>u,default:()=>d});var n=a(8403),l=a(77160),r=a(59249),c=a(32779),s=a(22819),i=a(26878),o=a(73772);const __=o.__,u=e=>{const[t,a]=(0,i.useState)(e.defaultValue||{type:"icon",icon:"",image:[]}),o=t=>{a(t),e.onChange&&e.onChange(t)};let u="";switch(t.type){case"icon":u=React.createElement(l.default,{title:__("Select icon","stachethemes_event_calendar_lite"),value:t.icon||"",description:__("Select icon for your thumbnail. Type * to list all icons.","stachethemes_event_calendar_lite"),onPick:e=>{o({...t,icon:e})}});break;case"date":break;case"image":u=React.createElement(r.default,{multiple:!1,value:t.image||[],buttonTitle:__("Select image","stachethemes_event_calendar_lite"),description:__("Select image for your thumbnail","stachethemes_event_calendar_lite"),onChange:e=>{o({...t,image:e})}})}return React.createElement(n.StecDiv,{className:"stec-input-thumb-type"},React.createElement(c.InputSelect,{title:e.title,description:e.description,options:[{value:"icon",label:__("Icon","stachethemes_event_calendar_lite")},{value:"date",label:__("Date","stachethemes_event_calendar_lite")},{value:"image",label:__("Image","stachethemes_event_calendar_lite")}],value:t.type?t.type:"icon",onChange:e=>{o({...t,type:e})}}),React.createElement(s.default,null),u,e.name&&React.createElement("input",{type:"hidden",name:e.name,value:JSON.stringify(t)}))},m=e=>{const t=t=>{e.onChange(t)};let a="";switch(e.value.type){case"icon":a=React.createElement(l.default,{title:__("Select icon","stachethemes_event_calendar_lite"),value:e.value.icon||"",description:__("Select icon for your thumbnail. Type * to list all icons.","stachethemes_event_calendar_lite"),onPick:a=>{t({...e.value,icon:a})}});break;case"date":break;case"image":a=React.createElement(r.default,{multiple:!1,value:e.value.image||[],buttonTitle:__("Select image","stachethemes_event_calendar_lite"),description:__("Select image for your thumbnail","stachethemes_event_calendar_lite"),onChange:a=>{t({...e.value,image:a})},onRemove:()=>{t({...e.value,image:[]})}})}return React.createElement(n.StecDiv,{className:"stec-input-thumb-type"},React.createElement(c.InputSelect,{title:e.title,description:e.description,options:[{value:"icon",label:__("Icon","stachethemes_event_calendar_lite")},{value:"date",label:__("Date","stachethemes_event_calendar_lite")},{value:"image",label:__("Image","stachethemes_event_calendar_lite")}],defaultValue:e.value.type?e.value.type:"icon",onChange:a=>{t({...e.value,type:a})}}),React.createElement(s.default,null),a)},d=m},13734:(e,t,a)=>{a.r(t),a.d(t,{UpsertForm:()=>C,default:()=>T});var n=a(52779),l=a(93699),r=a(62552),c=a(32779),s=a(32488),i=a(79051),o=a(48596),u=a(22819),m=a(98196),d=a(91927),h=a(81148),_=a(6405),p=a(13328),g=a(8403),v=a(73772),y=a(26960),f=a(26878),R=a(60799),E=a(73075);const __=v.__,b=e=>{const{wasSubmitted:t,focusFieldsRef:a,postData:n}=e,{items:l,ready:r,error:s}=(0,p.usePermissions)();return!r||s?null:React.createElement(React.Fragment,null,React.createElement(p.WithMaybeDisplayPermissions,{type:"edit_permission"},React.createElement(u.default,null),React.createElement(c.UncontrolledInputSelect,{ref:e=>a.current.edit_permission=e,multiple:!0,title:__("Edit permission","stachethemes_event_calendar_lite"),options:l.filter((e=>"stec_public"!==e.value)),defaultValue:n.current.meta.edit_permission,description:__("Who can edit this category","stachethemes_event_calendar_lite"),required:!0,errorMessage:__("The edit permission cannot be empty","stachethemes_event_calendar_lite"),wasSubmitted:t,onChange:e=>{n.current.meta.edit_permission=e}})),React.createElement(p.WithMaybeDisplayPermissions,{type:"use_permission"},React.createElement(u.default,null),React.createElement(c.UncontrolledInputSelect,{ref:e=>a.current.use_permission=e,multiple:!0,title:__("Use permission","stachethemes_event_calendar_lite"),options:l.filter((e=>"publish"!==e.value)),defaultValue:n.current.meta.use_permission,description:__("Who can submit events to this category","stachethemes_event_calendar_lite"),required:!0,errorMessage:__("The use permission cannot be empty","stachethemes_event_calendar_lite"),wasSubmitted:t,onChange:e=>{n.current.meta.use_permission=e}})))};function C(e){const[t,a]=(0,f.useState)(!1),[c,d]=(0,f.useState)(0),p=(0,f.useRef)(!1),g=E.default,v=(0,f.useRef)((0,y.cloneDeep)(e.template?e.template:g)),C=(0,f.useRef)([]),T=(e,t=!0)=>{v.current=t?(0,y.cloneDeep)(e):e,d((0,y.uniqueId)())},S=v.current.id?[React.createElement("i",{key:"icon",className:"fa-solid fa-pen-to-square"}),__("Edit category","stachethemes_event_calendar_lite")]:[React.createElement("i",{key:"icon",className:"fa-solid fa-plus"}),__("Add new category","stachethemes_event_calendar_lite")];return React.createElement(o.default,{title:S,key:c},React.createElement(h.default,{postData:v}),React.createElement(u.default,null),React.createElement(s.UncontrolledInputText,{ref:e=>C.current.name=e,title:__("Name"),defaultValue:v.current.name,placeholder:__("Category name","stachethemes_event_calendar_lite"),description:__("Category display name"),required:!0,regex:(0,_.getRegexByType)("title"),errorMessage:__("The category must have a name","stachethemes_event_calendar_lite"),wasSubmitted:t,onChange:e=>{v.current.name=e}}),React.createElement(u.default,null),React.createElement(s.UncontrolledInputText,{ref:e=>C.current.slug=e,title:__("Slug"),defaultValue:v.current.slug,placeholder:__("Category slug","stachethemes_event_calendar_lite"),description:__("Leave empty to auto-generate"),required:!1,regex:(0,_.getRegexByType)("slug"),errorMessage:__("The category must have a valid slug","stachethemes_event_calendar_lite"),onChange:e=>{v.current.slug=e},wasSubmitted:t}),React.createElement(u.default,null),React.createElement(r.UncontrolledInputColor,{title:__("Color","stachethemes_event_calendar_lite"),defaultValue:v.current.meta.color,description:__("Category color","stachethemes_event_calendar_lite"),onChange:e=>{v.current.meta.color=e}}),React.createElement(u.default,null),React.createElement(i.UncontrolledInputThumbType,{title:__("Thumbnail type","stachethemes_event_calendar_lite"),defaultValue:v.current.meta.thumbnail,description:__("Thumbnail type for your events. Events can override this value","stachethemes_event_calendar_lite"),onChange:e=>{v.current.meta.thumbnail=e}}),React.createElement(u.default,null),React.createElement(b,{postData:v,focusFieldsRef:C,wasSubmitted:t}),React.createElement(u.default,null),React.createElement(n.default,{label:v.current.id?__("Update","stachethemes_event_calendar_lite"):__("Create","stachethemes_event_calendar_lite",0),className:"green",onClick:()=>{if(!0!==p.current){if(a(!0),!1===(()=>{const e=[{id:"name",regex:(0,_.getRegexByType)("title"),meta:!1,errorMessage:__("The category must have a name","stachethemes_event_calendar_lite")},{id:"slug",regex:(0,_.getRegexByType)("slug"),meta:!1,errorMessage:__("The category must have a valid slug","stachethemes_event_calendar_lite")},{id:"use_permission",meta:!0,errorMessage:__("The use permission cannot be empty","stachethemes_event_calendar_lite")},{id:"edit_permission",meta:!0,errorMessage:__("The edit permission cannot be empty","stachethemes_event_calendar_lite")}];for(let t in e){const a=e[t],n=a.meta?v.current.meta[a.id]:v.current[a.id];let l=!0;if(l=a.regex?new RegExp(a.regex).test(n):Array.isArray(n)?n.length>0:!(!n||""===n),!1===l)return C.current[a.id]&&C.current[a.id].focus(),R.toast.error(a.errorMessage),!1}return!0})())return!1;R.toast.promise(new Promise(((t,a)=>{p.current=!0,async function(){try{let a;a=v.current.id?await(0,m.newApiPut)({route:"CATEGORIES",args:v.current.id,data:v.current,includeResponseStatus:!0,errorMessage:"auto"}):await(0,m.newApiPost)({route:"CATEGORIES",data:v.current,includeResponseStatus:!0,translateErrorCode:{term_exists:__("A category with this name already exists","stachethemes_event_calendar_lite")},errorMessage:"auto"});const{status:n,data:l}=a;switch(n){case 201:return e.onCategoryInserted&&e.onCategoryInserted(l),T(l),(0,m.flushApiCache)({group:"taxonomy-stec_cat"}),t(__("Created","stachethemes_event_calendar_lite"));case 200:return e.onCategoryInserted&&e.onCategoryInserted(l),T(l),(0,m.flushApiCache)({group:"taxonomy-stec_cat"}),t(__("Updated","stachethemes_event_calendar_lite"))}}catch(e){return a(e.message)}}()})),{loading:__("Saving","stachethemes_event_calendar_lite"),success:e=>(p.current=!1,e),error:e=>(p.current=!1,e)})}else(0,R.toast)(__("Another action is in progress","stachethemes_event_calendar_lite"))}}),React.createElement(n.default,{label:__("Reset form","stachethemes_event_calendar_lite"),className:"yellow",style:{marginLeft:5},onClick:()=>{T(g),a(!1),(0,R.toast)(__("The form has been reset","stachethemes_event_calendar_lite"))}}),v.current.id&&React.createElement(l.default,{label:__("Delete","stachethemes_event_calendar_lite"),className:"red",style:{marginLeft:5},onClick:()=>{!0!==p.current?R.toast.promise(new Promise(((t,a)=>{p.current=!0,async function(){try{await(0,m.newApiDelete)({route:"CATEGORIES",args:v.current.id});e.onCategoryDeleted&&e.onCategoryDeleted(v.current);const a=(0,y.cloneDeep)(v.current);return a.id="",T(a,!1),(0,m.flushApiCache)({group:"taxonomy-stec_cat"}),t(__("Deleted","stachethemes_event_calendar_lite"))}catch(e){return a(e.message)}}()})),{loading:__("Deleting","stachethemes_event_calendar_lite"),success:e=>(p.current=!1,e),error:e=>(p.current=!1,e)}):(0,R.toast)(__("Another action is in progress","stachethemes_event_calendar_lite"))}}),React.createElement(n.default,{label:__("Back","stachethemes_event_calendar_lite"),className:"blue",style:{marginLeft:5},onClick:()=>{const t=!v.current.id;e.onBack(t)}}))}const T=function(){const{setActiveMenu:e,activeMenuParams:t}=(0,d.useDashboardMenu)(),a=a=>{let n=t.manageListQueryArgs||null;a&&(n=null),e({page:"categories-list",params:{initialQueryArgs:n}})};return React.createElement(React.Fragment,null,React.createElement(g.StecDiv,{className:"stec-dashboard-top-nav"},React.createElement(n.default,{className:"stcolor stec-dashboard-home-button",label:[React.createElement("i",{key:"icon",className:"fa-solid fa-home"}),__("Home","stachethemes_event_calendar_lite")],onClick:()=>{e({page:"home",params:{}})}}),React.createElement(n.default,{className:"blue",label:[React.createElement("i",{key:"icon",className:"fa-solid fa-list"}),__("Manage categories","stachethemes_event_calendar_lite")],onClick:a})),React.createElement(C,{template:t.template||!1,onBack:e=>{a(e)}}))}},73075:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});const n=void 0!==window.STEC_CATEGORY_TEMPLATE?window.STEC_CATEGORY_TEMPLATE:{name:"",slug:"",status:"publish",meta:{author:"",color:"#A7C7E7",thumbnail:{type:"icon",icon:"",image:[]},read_permission:["stec_public"],use_permission:["stec_private"],edit_permission:["stec_private"]}}}}]);